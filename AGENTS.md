# ContractGuardAgent 开发计划

## 项目概述
基于 RAG + LangGraph 的法务合同智能对比系统

## 技术栈
- 后端: FastAPI + SQLite
- AI: LangChain + OpenAI
- 工作流: LangGraph
- 前端: 原生 HTML/CSS/JS

## 开发任务

### P0 - 核心功能（必须完成）

#### 1. 添加 LLM 集成
- [x] 安装 langchain-openai 依赖
- [x] 创建 LLM 服务封装 (app/services/llm.py)
- [x] 更新 nodes.py 使用 LLM 进行合同分析
- [x] 配置环境变量 (OPENAI_API_KEY)

#### 2. 任务数据持久化
- [x] 创建 tasks 数据库表
- [x] 修改 routes.py 使用数据库存储任务
- [x] 添加任务状态查询和更新逻辑

### P1 - 重要功能

#### 3. 并发任务错误处理
- [x] 添加任务重试机制
- [x] 实现任务状态轮询更新
- [x] 添加错误日志记录

#### 4. 完善 RAG 实现
- [x] 添加文本向量化处理
- [x] 实现语义检索功能
- [ ] 优化 playbook 规则匹配

#### 5. 前端功能完善
- [x] 实现合同文件上传
- [x] 添加结果详情页面
- [x] 完善对比页面交互

### P2 - 辅助功能

#### 6. 日志和配置
- [x] 添加日志系统 (logging)
- [x] 创建配置文件 (config.yaml)
- [x] 环境变量统一管理

#### 7. 测试
- [x] 添加单元测试
- [ ] 添加集成测试

## 验收标准

### P0 完成标准
- [x] LLM 可以分析合同差异并给出建议
- [x] 任务数据存储到数据库，重启后不丢失

### P1 完成标准
- [x] 任务失败可以重试
- [x] RAG 检索结果更准确
- [x] 前端可以上传文件和查看结果

### P2 完成标准
- [x] 日志正常输出
- [ ] 测试覆盖率 > 60%
